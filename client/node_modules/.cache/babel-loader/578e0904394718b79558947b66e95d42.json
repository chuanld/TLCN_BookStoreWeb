{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nfunction ProductsApi(token) {\n  _s();\n\n  const [isAdmin, setIsAdmin] = useState(false);\n  const [products, setProducts] = useState([]);\n  const [callback, setCallback] = useState(false);\n  const [category, setCategory] = useState(\"\");\n  const [sort, setSort] = useState(\"\");\n  const [search, setSearch] = useState(\"\");\n  const [page, setPage] = useState(1);\n  const [limit, setLimit] = useState(20);\n  const [result, setResult] = useState(0);\n  const [totalResult, setTotalResult] = useState(0);\n  const [countPage, setCountPage] = useState(1);\n  const [loadSklt, setLoadSklt] = useState(false);\n\n  const scrollToTop = () => {\n    window.scrollTo({\n      top: 587,\n      behavior: \"smooth\"\n    });\n  };\n\n  useEffect(() => {\n    if (token) {\n      const getUser = async () => {\n        try {\n          const res = await axios.get(\"/user/infor\", {\n            headers: {\n              Authorization: token\n            }\n          });\n          res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false);\n        } catch (err) {\n          alert(err.response.data.msg);\n        }\n      };\n\n      getUser();\n    }\n  }, [token]);\n  useEffect(() => {\n    if (token) {\n      if (isAdmin) {\n        const getProducts = async () => {\n          setLoadSklt(true);\n          const res = await axios.get(`/api/products?limit=${limit}&page=${page}&${category}&${sort}&title[regex]=${search}`);\n          setLoadSklt(false);\n          setProducts(res.data.products);\n          setResult(res.data.result);\n          setTotalResult(res.data.totalResult);\n          setCountPage(Math.ceil(res.data.totalResult / limit));\n          scrollToTop();\n          console.log(res);\n        };\n\n        getProducts();\n      }\n    }\n  }, [callback, limit, category, sort, page, search, token, isAdmin]);\n  return {\n    products: [products, setProducts],\n    callback: [callback, setCallback],\n    category: [category, setCategory],\n    sort: [sort, setSort],\n    search: [search, setSearch],\n    page: [page, setPage],\n    limit: [limit, setLimit],\n    result: [result, setResult],\n    totalResult: [totalResult, setTotalResult],\n    countPage: [countPage, setCountPage],\n    //Skeleton\n    loadSklt: [loadSklt, setLoadSklt]\n  };\n}\n\n_s(ProductsApi, \"8h+5qPHJVMFI0qDfM6UUsOzKaPY=\");\n\n_c = ProductsApi;\nexport default ProductsApi;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductsApi\");","map":{"version":3,"sources":["E:/HK1_Nam4/TLCN/Web-ban-hang/client/src/api/ProductsApiAdmin.js"],"names":["useState","useEffect","axios","ProductsApi","token","isAdmin","setIsAdmin","products","setProducts","callback","setCallback","category","setCategory","sort","setSort","search","setSearch","page","setPage","limit","setLimit","result","setResult","totalResult","setTotalResult","countPage","setCountPage","loadSklt","setLoadSklt","scrollToTop","window","scrollTo","top","behavior","getUser","res","get","headers","Authorization","data","role","err","alert","response","msg","getProducts","Math","ceil","console","log"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nfunction ProductsApi(token) {\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n  const [products, setProducts] = useState([]);\r\n  const [callback, setCallback] = useState(false);\r\n  const [category, setCategory] = useState(\"\");\r\n  const [sort, setSort] = useState(\"\");\r\n  const [search, setSearch] = useState(\"\");\r\n  const [page, setPage] = useState(1);\r\n  const [limit, setLimit] = useState(20);\r\n  const [result, setResult] = useState(0);\r\n  const [totalResult, setTotalResult] = useState(0);\r\n  const [countPage, setCountPage] = useState(1);\r\n\r\n  const [loadSklt, setLoadSklt] = useState(false);\r\n\r\n  const scrollToTop = () => {\r\n    window.scrollTo({\r\n      top: 587,\r\n      behavior: \"smooth\",\r\n    });\r\n  };\r\n  useEffect(() => {\r\n    if (token) {\r\n      const getUser = async () => {\r\n        try {\r\n          const res = await axios.get(\"/user/infor\", {\r\n            headers: { Authorization: token },\r\n          });\r\n          res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false);\r\n        } catch (err) {\r\n          alert(err.response.data.msg);\r\n        }\r\n      };\r\n      getUser();\r\n    }\r\n  }, [token]);\r\n  useEffect(() => {\r\n    if (token) {\r\n      if (isAdmin) {\r\n        const getProducts = async () => {\r\n          setLoadSklt(true);\r\n\r\n          const res = await axios.get(\r\n            `/api/products?limit=${limit}&page=${page}&${category}&${sort}&title[regex]=${search}`\r\n          );\r\n          setLoadSklt(false);\r\n          setProducts(res.data.products);\r\n          setResult(res.data.result);\r\n          setTotalResult(res.data.totalResult);\r\n          setCountPage(Math.ceil(res.data.totalResult / limit));\r\n\r\n          scrollToTop();\r\n          console.log(res);\r\n        };\r\n        getProducts();\r\n      }\r\n    }\r\n  }, [callback, limit, category, sort, page, search, token, isAdmin]);\r\n\r\n  return {\r\n    products: [products, setProducts],\r\n    callback: [callback, setCallback],\r\n    category: [category, setCategory],\r\n    sort: [sort, setSort],\r\n    search: [search, setSearch],\r\n    page: [page, setPage],\r\n    limit: [limit, setLimit],\r\n    result: [result, setResult],\r\n    totalResult: [totalResult, setTotalResult],\r\n    countPage: [countPage, setCountPage],\r\n    //Skeleton\r\n    loadSklt: [loadSklt, setLoadSklt],\r\n  };\r\n}\r\n\r\nexport default ProductsApi;\r\n"]},"metadata":{},"sourceType":"module"}