{"ast":null,"code":"var _jsxFileName = \"E:\\\\HK1_Nam4\\\\TLCN\\\\Web-ban-hang\\\\client\\\\src\\\\features\\\\adminpage\\\\features\\\\productlist\\\\ProductListAdmin.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from \"react\";\nimport { GlobalState } from \"../../../../GlobalState\";\nimport { Link } from \"react-router-dom\";\nimport Loading from \"../../../../utils/loading/Loading\";\nimport { Edit, DeleteForever } from \"@material-ui/icons\";\nimport \"./productlistadmin.css\";\nimport { toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ProductListAdmin() {\n  _s();\n\n  const state = useContext(GlobalState);\n  const [token] = state.token;\n  const [products, setProducts] = state.productsApiAdmin.products;\n  const [callback, setCallback] = state.productsApiAdmin.callback;\n  const [loading, setLoading] = useState(false);\n  const [onCheck, setOnCheck] = useState(false);\n  const [isCheck, setIsCheck] = useState(false);\n  const [enableDel, setEnableDel] = useState(false); // useEffect(() => {\n  //   const getProducts = async () => {\n  //     const res = await axios.get(\"/api/products\");\n  //     setProducts(res.data.products);\n  //   };\n  //   getProducts();\n  // }, [setProducts]);\n\n  const handleDelete = async (id, tagId, public_id) => {\n    try {\n      if (window.confirm(`Are you sure delete product ${tagId} ?`)) {\n        setLoading(true);\n        const destroyImg = await axios.post(\"/api/destroy\", {\n          public_id: public_id\n        }, {\n          headers: {\n            Authorization: token\n          }\n        });\n        const deleteProduct = await axios.delete(`/api/products/${id}`, {\n          headers: {\n            Authorization: token\n          }\n        });\n        setLoading(false);\n        setCallback(!callback);\n        setOnCheck(false);\n        setEnableDel(false);\n        toast.success(destroyImg.data.msg);\n        toast.success(deleteProduct.data.msg);\n      }\n    } catch (err) {\n      toast.error(err.response.data.msg);\n    }\n  };\n\n  const handleClickMulti = () => {\n    if (!onCheck) {\n      setOnCheck(true);\n      setIsCheck(false);\n      products.forEach(product => {\n        product.checked = false;\n      });\n      setProducts([...products]);\n    } else {\n      setOnCheck(false);\n      setEnableDel(false);\n    }\n  };\n\n  const handleClickBox = id => {\n    products.forEach(product => {\n      if (product._id === id) product.checked = !product.checked;\n    });\n    setProducts([...products]);\n    setEnableDel(true);\n  };\n\n  const handleCheckAll = () => {\n    products.forEach(product => {\n      product.checked = !isCheck;\n    });\n    setProducts([...products]);\n    setIsCheck(!isCheck);\n\n    if (!enableDel) {\n      setEnableDel(true);\n    }\n  };\n\n  const handleDeleteAll = async () => {\n    await products.forEach(product => {\n      if (product.checked) {\n        handleDelete(product._id, product.product_id, product.images.public_id);\n      }\n    });\n  };\n\n  if (loading) return /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"productListAdmin\",\n      children: [products.length === 0 && /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 35\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"productListTitle\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"List products in Database\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [onCheck && enableDel ? /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"productDelAllButton\",\n            onClick: handleDeleteAll,\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 15\n          }, this) : null, /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"productAddButton\",\n            onClick: handleClickMulti,\n            children: onCheck ? \"Cancel check\" : \"Select multiple\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"productListTitle\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/createproduct\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"productAddButton\",\n            children: \"Create Product\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), onCheck ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"multiselect\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Select all\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: isCheck,\n            onChange: handleCheckAll\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 13\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"productsList\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"productListProduct\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"col_id_productlist\",\n                children: \"Tag ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"col_title_productlist\",\n                children: \"Title\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"col_price_productlist\",\n                children: \"Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 133,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"col_sold_productlist\",\n                children: \"Sold\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 134,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"col_author_productlist\",\n                children: \"Author\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"col_publisher_productlist\",\n                children: \"Publisher\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 136,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Image\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"col_action_productlist\",\n                children: \"Action\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 138,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: products.map(item => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"col_id_productlist\",\n                children: item.product_id\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"col_title_productlist\",\n                children: item.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"col_price_productlist\",\n                children: item.price\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"col_sold_productlist\",\n                children: item.sold\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"col_author_productlist\",\n                children: item.author\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"col_publisher_productlist\",\n                children: item.publisher\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: item.images.url,\n                  alt: \"\",\n                  height: \"120px\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"col_action_productlist\",\n                children: [/*#__PURE__*/_jsxDEV(Link, {\n                  to: `/productdetail/${item._id}`,\n                  children: /*#__PURE__*/_jsxDEV(Edit, {\n                    className: \"productListEdit\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 157,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 21\n                }, this), onCheck ? /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  checked: item.checked,\n                  className: \"productListDelete\",\n                  onChange: () => handleClickBox(item._id)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 161,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(DeleteForever, {\n                  className: \"productListDelete\",\n                  onClick: () => handleDelete(item._id, item.product_id, item.images.public_id)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 19\n              }, this)]\n            }, item._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(ProductListAdmin, \"6xOfqF05ZcLTizOQR5WpsjTxSPo=\");\n\n_c = ProductListAdmin;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductListAdmin\");","map":{"version":3,"sources":["E:/HK1_Nam4/TLCN/Web-ban-hang/client/src/features/adminpage/features/productlist/ProductListAdmin.js"],"names":["React","useContext","useState","GlobalState","Link","Loading","Edit","DeleteForever","toast","axios","ProductListAdmin","state","token","products","setProducts","productsApiAdmin","callback","setCallback","loading","setLoading","onCheck","setOnCheck","isCheck","setIsCheck","enableDel","setEnableDel","handleDelete","id","tagId","public_id","window","confirm","destroyImg","post","headers","Authorization","deleteProduct","delete","success","data","msg","err","error","response","handleClickMulti","forEach","product","checked","handleClickBox","_id","handleCheckAll","handleDeleteAll","product_id","images","length","map","item","title","price","sold","author","publisher","url"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from \"react\";\r\nimport { GlobalState } from \"../../../../GlobalState\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Loading from \"../../../../utils/loading/Loading\";\r\nimport { Edit, DeleteForever } from \"@material-ui/icons\";\r\nimport \"./productlistadmin.css\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\nimport axios from \"axios\";\r\n\r\nexport default function ProductListAdmin() {\r\n  const state = useContext(GlobalState);\r\n  const [token] = state.token;\r\n  const [products, setProducts] = state.productsApiAdmin.products;\r\n  const [callback, setCallback] = state.productsApiAdmin.callback;\r\n  const [loading, setLoading] = useState(false);\r\n  const [onCheck, setOnCheck] = useState(false);\r\n  const [isCheck, setIsCheck] = useState(false);\r\n  const [enableDel, setEnableDel] = useState(false);\r\n  // useEffect(() => {\r\n  //   const getProducts = async () => {\r\n  //     const res = await axios.get(\"/api/products\");\r\n  //     setProducts(res.data.products);\r\n  //   };\r\n  //   getProducts();\r\n  // }, [setProducts]);\r\n\r\n  const handleDelete = async (id, tagId, public_id) => {\r\n    try {\r\n      if (window.confirm(`Are you sure delete product ${tagId} ?`)) {\r\n        setLoading(true);\r\n        const destroyImg = await axios.post(\r\n          \"/api/destroy\",\r\n          { public_id: public_id },\r\n          {\r\n            headers: { Authorization: token },\r\n          }\r\n        );\r\n        const deleteProduct = await axios.delete(`/api/products/${id}`, {\r\n          headers: { Authorization: token },\r\n        });\r\n        setLoading(false);\r\n        setCallback(!callback);\r\n        setOnCheck(false);\r\n        setEnableDel(false);\r\n        toast.success(destroyImg.data.msg);\r\n        toast.success(deleteProduct.data.msg);\r\n      }\r\n    } catch (err) {\r\n      toast.error(err.response.data.msg);\r\n    }\r\n  };\r\n\r\n  const handleClickMulti = () => {\r\n    if (!onCheck) {\r\n      setOnCheck(true);\r\n      setIsCheck(false);\r\n      products.forEach((product) => {\r\n        product.checked = false;\r\n      });\r\n      setProducts([...products]);\r\n    } else {\r\n      setOnCheck(false);\r\n      setEnableDel(false);\r\n    }\r\n  };\r\n  const handleClickBox = (id) => {\r\n    products.forEach((product) => {\r\n      if (product._id === id) product.checked = !product.checked;\r\n    });\r\n    setProducts([...products]);\r\n    setEnableDel(true);\r\n  };\r\n  const handleCheckAll = () => {\r\n    products.forEach((product) => {\r\n      product.checked = !isCheck;\r\n    });\r\n    setProducts([...products]);\r\n    setIsCheck(!isCheck);\r\n    if (!enableDel) {\r\n      setEnableDel(true);\r\n    }\r\n  };\r\n\r\n  const handleDeleteAll = async () => {\r\n    await products.forEach((product) => {\r\n      if (product.checked) {\r\n        handleDelete(product._id, product.product_id, product.images.public_id);\r\n      }\r\n    });\r\n  };\r\n\r\n  if (loading) return <Loading />;\r\n  return (\r\n    <>\r\n      <div className=\"productListAdmin\">\r\n        {products.length === 0 && <Loading />}\r\n        <div className=\"productListTitle\">\r\n          <h4>List products in Database</h4>\r\n          <div>\r\n            {onCheck && enableDel ? (\r\n              <button className=\"productDelAllButton\" onClick={handleDeleteAll}>\r\n                Delete\r\n              </button>\r\n            ) : null}\r\n            <button className=\"productAddButton\" onClick={handleClickMulti}>\r\n              {onCheck ? \"Cancel check\" : \"Select multiple\"}\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div className=\"productListTitle\">\r\n          <Link to=\"/createproduct\">\r\n            <button className=\"productAddButton\">Create Product</button>\r\n          </Link>\r\n          {onCheck ? (\r\n            <div className=\"multiselect\">\r\n              <span>Select all</span>\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={isCheck}\r\n                onChange={handleCheckAll}\r\n              />\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n        <div className=\"productsList\">\r\n          <table className=\"productListProduct\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"col_id_productlist\">Tag ID</th>\r\n                <th className=\"col_title_productlist\">Title</th>\r\n                <th className=\"col_price_productlist\">Price</th>\r\n                <th className=\"col_sold_productlist\">Sold</th>\r\n                <th className=\"col_author_productlist\">Author</th>\r\n                <th className=\"col_publisher_productlist\">Publisher</th>\r\n                <th>Image</th>\r\n                <th className=\"col_action_productlist\">Action</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {products.map((item) => (\r\n                <tr key={item._id}>\r\n                  <td className=\"col_id_productlist\">{item.product_id}</td>\r\n                  <td className=\"col_title_productlist\">{item.title}</td>\r\n                  <td className=\"col_price_productlist\">{item.price}</td>\r\n                  <td className=\"col_sold_productlist\">{item.sold}</td>\r\n                  <td className=\"col_author_productlist\">{item.author}</td>\r\n                  <td className=\"col_publisher_productlist\">\r\n                    {item.publisher}\r\n                  </td>\r\n                  <td>\r\n                    <img src={item.images.url} alt=\"\" height=\"120px\" />\r\n                  </td>\r\n                  <td className=\"col_action_productlist\">\r\n                    <Link to={`/productdetail/${item._id}`}>\r\n                      <Edit className=\"productListEdit\" />\r\n                    </Link>\r\n\r\n                    {onCheck ? (\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={item.checked}\r\n                        className=\"productListDelete\"\r\n                        onChange={() => handleClickBox(item._id)}\r\n                      />\r\n                    ) : (\r\n                      <DeleteForever\r\n                        className=\"productListDelete\"\r\n                        onClick={() =>\r\n                          handleDelete(\r\n                            item._id,\r\n                            item.product_id,\r\n                            item.images.public_id\r\n                          )\r\n                        }\r\n                      />\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}